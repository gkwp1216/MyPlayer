# 📋 Phase 2: YOLO 라벨링 가이드

## 🎯 목표
메이플스토리 게임 화면에서 **버프 상태**, **스킬 쿨타임**, **경험치 도핑 상태**를 실시간으로 추적하여 자동으로 행동을 결정하는 AI 구축

---

## 📊 클래스 정의 및 라벨링 기준

### 1️⃣ `skill_cooldown` - 스킬 쿨타임 상태
**목적**: 스킬 퀵슬롯에서 쿨타임이 진행 중인 스킬을 탐지

**라벨링 기준**:
- **탐지 대상**: 스킬 아이콘 위에 어두운 오버레이 또는 숫자(남은 쿨타임)가 표시된 상태
- **바운딩 박스**: 스킬 아이콘 전체를 포함 (테두리 포함)
- **위치**: 화면 하단 스킬 퀵슬롯 (보통 F1~F12, 또는 1~9 키 위치)

**스크린샷 예시 상황**:
```
✅ 캡처해야 할 상황:
- 스킬 아이콘이 어둡게 표시되고 숫자가 오버레이된 상태
- 쿨타임이 1초 남았을 때부터 최대 쿨타임까지 다양하게
- 여러 스킬이 동시에 쿨타임일 때

❌ 캡처하지 말아야 할 상황:
- 스킬이 사용 가능한 밝은 상태 (이건 라벨링 안 함)
```

**행동 로직**:
- `skill_cooldown` 탐지 → **사냥 계속 진행** (다른 스킬 사용)
- `skill_cooldown` 미탐지 → 스킬 사용 가능

---

### 2️⃣ `buff_time_low` - 버프 지속시간 임박
**목적**: 버프 즐겨찾기 영역에서 지속시간이 얼마 남지 않은 버프를 탐지

**라벨링 기준**:
- **탐지 대상**: 버프 즐겨찾기에서 남은 시간이 **10초 이하**인 버프 아이콘
- **바운딩 박스**: 버프 아이콘 + 남은 시간 텍스트를 모두 포함
- **위치**: 화면 우측 상단 또는 좌측 상단 (버프 즐겨찾기 위치)
- **색상/표시**: 보통 노란색 또는 빨간색으로 경고 표시되거나, 숫자가 10 이하

**스크린샷 예시 상황**:
```
✅ 캡처해야 할 상황:
- 버프 남은 시간이 10초, 9초, 8초... 1초일 때
- 설치기 버프가 5초 남았을 때
- 여러 버프가 동시에 임박할 때

❌ 캡처하지 말아야 할 상황:
- 버프 남은 시간이 30초 이상 (충분히 남음)
- 버프 아이콘만 있고 시간 표시가 없는 경우
```

**행동 로직**:
- `buff_time_low` 탐지 → **버프 사용 위치로 이동 + 버프 재사용**
- 미탐지 → 사냥 계속

---

### 3️⃣ `exp_doping_active` - 경험치 도핑 활성화 상태
**목적**: 경험치 도핑(버프)이 현재 활성화되어 있는지 확인

**라벨링 기준**:
- **탐지 대상**: 화면 좌측 상단 버프 영역에 경험치 관련 버프 아이콘이 **존재**하는 상태
- **바운딩 박스**: 경험치 도핑 아이콘 전체 (예: 노란색 병, 황금 물약 등)
- **위치**: 좌측 상단 버프 목록 (일반적으로 캐릭터 스탯 아래)

**스크린샷 예시 상황**:
```
✅ 캡처해야 할 상황:
- 경험치 2배 버프 아이콘이 표시된 상태
- 경험치 쿠폰, 익스트림 골드 등 도핑 아이콘이 보이는 상태
- 여러 경험치 버프가 동시에 적용된 상태

❌ 캡처하지 말아야 할 상황:
- 경험치 도핑이 하나도 없는 상태 (다음 클래스에서 처리)
```

**행동 로직**:
- `exp_doping_active` 탐지 → **정상 사냥 진행**
- 미탐지 → 경험치 도핑 사용 필요

---

### 4️⃣ `exp_doping_missing` - 경험치 도핑 미적용 상태
**목적**: 경험치 도핑이 **전혀 없는** 상태를 탐지하여 재사용 트리거

**라벨링 기준**:
- **탐지 대상**: 화면 좌측 상단 버프 영역에 경험치 도핑 아이콘이 **없는** 빈 공간
- **바운딩 박스**: 경험치 도핑이 있어야 할 위치를 빈 공간으로 표시
- **특수 케이스**: 이 클래스는 "부재(absence)"를 탐지하므로, 다른 버프는 있지만 경험치 도핑만 없는 상태

**스크린샷 예시 상황**:
```
✅ 캡처해야 할 상황:
- 버프 목록에 다른 버프는 있지만 경험치 도핑 아이콘이 없는 상태
- 버프 목록이 완전히 비어있는 상태
- 경험치 도핑이 막 만료된 직후

❌ 캡처하지 말아야 할 상황:
- 경험치 도핑이 하나라도 활성화된 상태
```

**행동 로직**:
- `exp_doping_missing` 탐지 → **즉시 경험치 도핑 재사용**
- 미탐지 → 정상 사냥

---

### 5️⃣ `skill_ready` - 스킬 사용 가능 상태 (선택)
**목적**: 스킬이 쿨타임 없이 사용 가능한 상태

**라벨링 기준**:
- **탐지 대상**: 밝게 표시된 스킬 아이콘 (쿨타임 오버레이 없음)
- **바운딩 박스**: 스킬 아이콘 전체
- **위치**: 화면 하단 스킬 퀵슬롯

**스크린샷 예시 상황**:
```
✅ 캡처해야 할 상황:
- 스킬 아이콘이 밝게 표시되고 즉시 사용 가능한 상태
- 설치기 스킬이 쿨타임이 끝난 상태

❌ 캡처하지 말아야 할 상황:
- 어둡게 표시되거나 쿨타임이 있는 상태
```

**행동 로직**:
- `skill_ready` 탐지 → **해당 스킬 즉시 사용**

---

## 📁 데이터셋 디렉토리 구조

```
MyPlayer/
├── datasets/
│   ├── raw/                    # 원본 스크린샷 보관
│   │   ├── skill_cooldown/
│   │   ├── buff_time_low/
│   │   ├── exp_doping_active/
│   │   ├── exp_doping_missing/
│   │   └── skill_ready/
│   │
│   ├── images/                 # 라벨링된 이미지
│   │   ├── train/              # 학습용 (80%)
│   │   ├── val/                # 검증용 (10%)
│   │   └── test/               # 테스트용 (10%)
│   │
│   └── labels/                 # YOLO 포맷 라벨 (.txt)
│       ├── train/
│       ├── val/
│       └── test/
│
└── data.yaml                   # YOLO 학습 설정 파일
```

---

## 🎬 스크린샷 수집 가이드

### 권장 수집 방법

1. **다양한 사냥터에서 촬영**
   - 엘다, 츄츄, 아르카나 등 여러 맵
   - 배경이 다른 환경

2. **다양한 시간대 촬영**
   - 버프 만료 10초 전
   - 버프 만료 5초 전
   - 버프 만료 1초 전
   - 쿨타임 5초 남음, 10초 남음, 30초 남음 등

3. **각 클래스당 최소 수량**
   - **최소**: 각 50장
   - **권장**: 각 100~200장
   - **이상적**: 각 300장 이상

4. **촬영 단축키 설정**
   - Windows: `Win + Shift + S` (부분 캡처)
   - 또는 게임 내 스크린샷 기능 사용
   - 빠르게 연속 촬영 가능하도록 설정

---

## 🖼️ 라벨링 툴 추천

### 방법 1: Roboflow (온라인, 추천) ⭐
- **장점**: 웹 기반, 협업 가능, 자동 데이터 증강
- **사용법**:
  1. https://roboflow.com 회원가입
  2. New Project → Object Detection
  3. 이미지 업로드 후 바운딩 박스 그리기
  4. 클래스별로 라벨링
  5. Export → YOLO 포맷으로 다운로드

### 방법 2: LabelImg (오프라인)
- **설치**:
  ```powershell
  py -m pip install labelImg
  labelImg
  ```
- **사용법**:
  1. Open Dir로 이미지 폴더 선택
  2. `W` 키로 바운딩 박스 생성
  3. 클래스 선택 후 저장
  4. 자동으로 YOLO 포맷 `.txt` 파일 생성

### 방법 3: CVAT (협업용)
- 팀 단위 라벨링 시 유용

---

## 📝 라벨링 팁

### 바운딩 박스 그리는 요령
```
✅ 좋은 바운딩 박스:
- 객체를 딱 맞게 포함 (여백 최소)
- 텍스트도 함께 표시되는 경우 텍스트까지 포함
- 일관된 기준으로 라벨링

❌ 나쁜 바운딩 박스:
- 너무 큰 여백 (배경이 많이 포함)
- 객체 일부가 잘림
- 비슷한 객체마다 다른 기준 적용
```

### 라벨링 시 주의사항
1. **일관성 유지**: 같은 클래스는 항상 같은 기준으로
2. **경계 명확히**: 여러 버프가 붙어있을 때 하나씩 분리
3. **중첩 허용**: 여러 객체가 겹쳐도 각각 라벨링
4. **품질 > 수량**: 정확한 50장이 부정확한 200장보다 나음

---

## 🚀 다음 단계

라벨링이 완료되면:

1. **데이터셋 검증**
   - 각 클래스별 최소 50장 이상 확보 확인
   - train/val/test 분할 (8:1:1 비율)

2. **YOLO 학습 준비**
   - `data.yaml` 파일 작성
   - 학습 명령어 실행

3. **모델 테스트**
   - 실제 게임 화면에서 실시간 탐지 테스트
   - 정확도 확인 및 개선

---

## 📞 라벨링 중 문제 발생 시

- 클래스 구분이 모호한 경우 → 새로운 서브클래스 추가 고려
- 탐지가 어려운 경우 → 더 많은 예시 데이터 수집
- 배경이 복잡한 경우 → 데이터 증강(augmentation) 활용

---

**다음 문서**: `PHASE2_TRAINING_GUIDE.md` - 데이터셋 준비 및 YOLO 학습 실행
